name: Main workflow

on:
  # Possibility to run it manually
  workflow_dispatch:
    inputs:
      trigger_all_builds:
        description: build all images
        default: false
        type: boolean
        required: true
  push:
    paths:
      - ".github/workflows/main-workflow.yml"
      - ".github/workflows/build-image.yml"
      - ".github/workflows/start-build.yml"
      - "Dockerfile"
      - "Dockerfile-alpine"
      - "commit-check.sh"
  # Automated
  schedule:
    # Run Every hour
    - cron: "0 * * * *"

jobs:
  check-for-new-caddy-release:
    runs-on: ubuntu-latest
    outputs:
      caddy: ${{ steps.git-check.outputs.caddy-out-of-date }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Fetch release version
        run: |
          curl -sL https://api.github.com/repos/caddyserver/caddy/releases/latest | \
          jq -r ".tag_name" > git-hashes/caddy-release.txt

      - name: Check for modified files
        id: git-check
        run: echo "caddy-out-of-date=$([ -z "`git status --porcelain`" ] && echo "false" || echo "true")" >> $GITHUB_OUTPUT

  update-caddy-build-version:
    runs-on: ubuntu-latest
    needs: check-for-new-caddy-release
    if: ${{ needs.check-for-new-caddy-release.outputs.caddy == 'true' }}
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Fetch release version
        run: |
          curl -sL https://api.github.com/repos/caddyserver/caddy/releases/latest | \
          jq -r ".tag_name" > git-hashes/caddy-release.txt

      - name: Commit latest build version
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git pull
          git add git-hashes/caddy-release.txt
          git commit -am "update current caddy build version"

      - name: Push changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          branch: ${{ github.ref }}

  check-for-plugin-updates:
    runs-on: ubuntu-latest
    needs: check-for-new-caddy-release
    outputs:
      desec: ${{ steps.desec.outputs.desec-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      cloudflare: ${{ steps.cloudflare.outputs.cloudflare-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      duckdns: ${{ steps.duckdns.outputs.duckdns-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      route53: ${{ steps.route53.outputs.route53-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      namecheap: ${{ steps.namecheap.outputs.namecheap-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      digitalocean: ${{ steps.digitalocean.outputs.digitalocean-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      hetzner: ${{ steps.hetzner.outputs.hetzner-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      acmedns: ${{ steps.acmedns.outputs.acmedns-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      alidns: ${{ steps.alidns.outputs.alidns-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      dnspod: ${{ steps.dnspod.outputs.dnspod-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      google-domains: ${{ steps.google-domains.outputs.google-domains-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      vercel: ${{ steps.vercel.outputs.vercel-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      netcup: ${{ steps.netcup.outputs.netcup-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      powerdns: ${{ steps.powerdns.outputs.powerdns-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      googleclouddns: ${{ steps.googleclouddns.outputs.googleclouddns-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      ovh: ${{ steps.ovh.outputs.ovh-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      netlify: ${{ steps.netlify.outputs.netlify-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      ionos: ${{ steps.ionos.outputs.ionos-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      porkbun: ${{ steps.porkbun.outputs.porkbun-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      gandi: ${{ steps.gandi.outputs.gandi-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      dynv6: ${{ steps.dynv6.outputs.dynv6-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      openstack-designate: ${{ steps.openstack-designate.outputs.openstack-designate-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      njalla: ${{ steps.njalla.outputs.njalla-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      rfc2136: ${{ steps.rfc2136.outputs.rfc2136-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      leaseweb: ${{ steps.leaseweb.outputs.leaseweb-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}
      linode: ${{ steps.linode.outputs.linode-out-of-date || steps.caddy-check.outputs.plugins-out-of-date }}

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: trigger all builds if there is a new caddy release or if requested
        if: ${{ github.event.inputs.trigger_all_builds == 'true' || needs.check-for-new-caddy-release.outputs.caddy == 'true' }}
        id: caddy-check
        run: |
          echo "plugins-out-of-date=true" >> $GITHUB_OUTPUT

      - name: Pull desec plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default
        id: desec
        run: sh commit-check.sh https://github.com/caddy-dns/desec desec-local.txt git-hashes/desec.txt desec-out-of-date

      - name: Pull cloudflare plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: cloudflare
        run: sh commit-check.sh https://github.com/caddy-dns/cloudflare cloudflare-local.txt git-hashes/cloudflare.txt cloudflare-out-of-date

      - name: Pull duckdns plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: duckdns
        run: sh commit-check.sh https://github.com/caddy-dns/duckdns duckdns-local.txt git-hashes/duckdns.txt duckdns-out-of-date

      - name: Pull route53 plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: route53
        run: sh commit-check.sh https://github.com/caddy-dns/route53 route53-local.txt git-hashes/route53.txt route53-out-of-date

      - name: Pull namecheap plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: namecheap
        run: sh commit-check.sh https://github.com/caddy-dns/namecheap namecheap-local.txt git-hashes/namecheap.txt namecheap-out-of-date

      - name: Pull digitalocean plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: digitalocean
        run: sh commit-check.sh https://github.com/caddy-dns/digitalocean digitalocean-local.txt git-hashes/digitalocean.txt digitalocean-out-of-date

      - name: Pull hetzner plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: hetzner
        run: sh commit-check.sh https://github.com/caddy-dns/hetzner hetzner-local.txt git-hashes/hetzner.txt hetzner-out-of-date

      - name: Pull acmedns plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: acmedns
        run: sh commit-check.sh https://github.com/caddy-dns/acmedns acmedns-local.txt git-hashes/acmedns.txt acmedns-out-of-date

      - name: Pull alidns plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: alidns
        run: sh commit-check.sh https://github.com/caddy-dns/alidns alidns-local.txt git-hashes/alidns.txt alidns-out-of-date

      - name: Pull dnspod plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: dnspod
        run: sh commit-check.sh https://github.com/caddy-dns/dnspod dnspod-local.txt git-hashes/dnspod.txt dnspod-out-of-date

      - name: Pull google-domains plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: google-domains
        run: sh commit-check.sh https://github.com/caddy-dns/google-domains google-domains-local.txt git-hashes/google-domains.txt google-domains-out-of-date

      - name: Pull vercel plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: vercel
        run: sh commit-check.sh https://github.com/caddy-dns/vercel vercel-local.txt git-hashes/vercel.txt vercel-out-of-date

      - name: Pull netcup plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: netcup
        run: sh commit-check.sh https://github.com/caddy-dns/netcup netcup-local.txt git-hashes/netcup.txt netcup-out-of-date

      - name: Pull powerdns plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: powerdns
        run: sh commit-check.sh https://github.com/caddy-dns/powerdns powerdns-local.txt git-hashes/powerdns.txt powerdns-out-of-date

      - name: Pull googleclouddns plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: googleclouddns
        run: sh commit-check.sh https://github.com/caddy-dns/googleclouddns googleclouddns-local.txt git-hashes/googleclouddns.txt googleclouddns-out-of-date

      - name: Pull ovh plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: ovh
        run: sh commit-check.sh https://github.com/caddy-dns/ovh ovh-local.txt git-hashes/ovh.txt ovh-out-of-date

      - name: Pull netlify plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: netlify
        run: sh commit-check.sh https://github.com/caddy-dns/netlify netlify-local.txt git-hashes/netlify.txt netlify-out-of-date

      - name: Pull ionos plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: ionos
        run: sh commit-check.sh https://github.com/caddy-dns/ionos ionos-local.txt git-hashes/ionos.txt ionos-out-of-date

      - name: Pull porkbun plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: porkbun
        run: sh commit-check.sh https://github.com/caddy-dns/porkbun porkbun-local.txt git-hashes/porkbun.txt porkbun-out-of-date

      - name: Pull gandi plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: gandi
        run: sh commit-check.sh https://github.com/caddy-dns/gandi gandi-local.txt git-hashes/gandi.txt gandi-out-of-date

      - name: Pull dynv6 plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: dynv6
        run: sh commit-check.sh https://github.com/caddy-dns/dynv6 dynv6-local.txt git-hashes/dynv6.txt dynv6-out-of-date

      - name: Pull openstack-designate plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: openstack-designate
        run: sh commit-check.sh https://github.com/caddy-dns/openstack-designate openstack-designate-local.txt git-hashes/openstack-designate.txt openstack-designate-out-of-date

      - name: Pull njalla plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: njalla
        run: sh commit-check.sh https://github.com/caddy-dns/njalla njalla-local.txt git-hashes/njalla.txt njalla-out-of-date

      - name: Pull rfc2136 plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: rfc2136
        run: sh commit-check.sh https://github.com/caddy-dns/rfc2136 rfc2136-local.txt git-hashes/rfc2136.txt rfc2136-out-of-date

      - name: Pull leaseweb plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: leaseweb
        run: sh commit-check.sh https://github.com/caddy-dns/leaseweb leaseweb-local.txt git-hashes/leaseweb.txt leaseweb-out-of-date

      - name: Pull linode plugin remote commits
        if: ${{ github.event.inputs.trigger_all_builds == 'false' || github.event.inputs.trigger_all_builds == '' && needs.check-for-new-caddy-release.outputs.caddy == 'false' }} #workaround, github inputs will be empty by default        
        id: linode
        run: sh commit-check.sh https://github.com/caddy-dns/linode linode-local.txt git-hashes/linode.txt linode-out-of-date

  trigger-desec-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.desec == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with desec dns plugin
      license: MIT
      tag: desec
      alpine_tag: desec-alpine
      go_plugin_link: github.com/caddy-dns/desec
      hash_file: git-hashes/desec.txt
      plugin_name: desec
      repo: https://github.com/caddy-dns/desec

  trigger-cloudflare-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.cloudflare == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with cloudflare dns plugin
      license: MIT
      tag: cloudflare
      alpine_tag: cloudflare-alpine
      go_plugin_link: github.com/caddy-dns/cloudflare
      hash_file: git-hashes/cloudflare.txt
      plugin_name: cloudflare
      repo: https://github.com/caddy-dns/cloudflare

  trigger-duckdns-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.duckdns == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with duckdns dns plugin
      license: MIT
      tag: duckdns
      alpine_tag: duckdns-alpine
      go_plugin_link: github.com/caddy-dns/duckdns
      hash_file: git-hashes/duckdns.txt
      plugin_name: duckdns
      repo: https://github.com/caddy-dns/duckdns

  trigger-route53-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.route53 == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with route53 dns plugin
      license: MIT
      tag: route53
      alpine_tag: route53-alpine
      go_plugin_link: github.com/caddy-dns/route53
      hash_file: git-hashes/route53.txt
      plugin_name: route53
      repo: https://github.com/caddy-dns/route53

  trigger-namecheap-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.namecheap == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with namecheap dns plugin
      license: MIT
      tag: namecheap
      alpine_tag: namecheap-alpine
      go_plugin_link: github.com/caddy-dns/namecheap
      hash_file: git-hashes/namecheap.txt
      plugin_name: namecheap
      repo: https://github.com/caddy-dns/namecheap

  trigger-digitalocean-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.digitalocean == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with digitalocean dns plugin
      license: MIT
      tag: digitalocean
      alpine_tag: digitalocean-alpine
      go_plugin_link: github.com/caddy-dns/digitalocean
      hash_file: git-hashes/digitalocean.txt
      plugin_name: digitalocean
      repo: https://github.com/caddy-dns/digitalocean

  trigger-hetzner-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.hetzner == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with hetzner dns plugin
      license: MIT
      tag: hetzner
      alpine_tag: hetzner-alpine
      go_plugin_link: github.com/caddy-dns/hetzner
      hash_file: git-hashes/hetzner.txt
      plugin_name: hetzner
      repo: https://github.com/caddy-dns/hetzner

  trigger-acmedns-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.acmedns == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with acmedns dns plugin
      license: MIT
      tag: acmedns
      alpine_tag: acmedns-alpine
      go_plugin_link: github.com/caddy-dns/acmedns
      hash_file: git-hashes/acmedns.txt
      plugin_name: acmedns
      repo: https://github.com/caddy-dns/acmedns

  trigger-alidns-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.alidns == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with alidns dns plugin
      license: MIT
      tag: alidns
      alpine_tag: alidns-alpine
      go_plugin_link: github.com/caddy-dns/alidns
      hash_file: git-hashes/alidns.txt
      plugin_name: alidns
      repo: https://github.com/caddy-dns/alidns

  trigger-dnspod-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.dnspod == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with dnspod dns plugin
      license: MIT
      tag: dnspod
      alpine_tag: dnspod-alpine
      go_plugin_link: github.com/caddy-dns/dnspod
      hash_file: git-hashes/dnspod.txt
      plugin_name: dnspod
      repo: https://github.com/caddy-dns/dnspod

  trigger-google-domains-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.google-domains == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with google-domains dns plugin
      license: MIT
      tag: google-domains
      alpine_tag: google-domains-alpine
      go_plugin_link: github.com/caddy-dns/google-domains
      hash_file: git-hashes/google-domains.txt
      plugin_name: google-domains
      repo: https://github.com/caddy-dns/google-domains

  trigger-vercel-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.vercel == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with vercel dns plugin
      license: MIT
      tag: vercel
      alpine_tag: vercel-alpine
      go_plugin_link: github.com/caddy-dns/vercel
      hash_file: git-hashes/vercel.txt
      plugin_name: vercel
      repo: https://github.com/caddy-dns/vercel

  trigger-netcup-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.netcup == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with netcup dns plugin
      license: MIT
      tag: netcup
      alpine_tag: netcup-alpine
      go_plugin_link: github.com/caddy-dns/netcup
      hash_file: git-hashes/netcup.txt
      plugin_name: netcup
      repo: https://github.com/caddy-dns/netcup

  trigger-powerdns-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.powerdns == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with powerdns dns plugin
      license: MIT
      tag: powerdns
      alpine_tag: powerdns-alpine
      go_plugin_link: github.com/caddy-dns/powerdns
      hash_file: git-hashes/powerdns.txt
      plugin_name: powerdns
      repo: https://github.com/caddy-dns/powerdns

  trigger-googleclouddns-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.googleclouddns == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with googleclouddns dns plugin
      license: MIT
      tag: googleclouddns
      alpine_tag: googleclouddns-alpine
      go_plugin_link: github.com/caddy-dns/googleclouddns
      hash_file: git-hashes/googleclouddns.txt
      plugin_name: googleclouddns
      repo: https://github.com/caddy-dns/googleclouddns

  trigger-ovh-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.ovh == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with ovh dns plugin
      license: MIT
      tag: ovh
      alpine_tag: ovh-alpine
      go_plugin_link: github.com/caddy-dns/ovh
      hash_file: git-hashes/ovh.txt
      plugin_name: ovh
      repo: https://github.com/caddy-dns/ovh

  trigger-netlify-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.netlify == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with netlify dns plugin
      license: MIT
      tag: netlify
      alpine_tag: netlify-alpine
      go_plugin_link: github.com/caddy-dns/netlify
      hash_file: git-hashes/netlify.txt
      plugin_name: netlify
      repo: https://github.com/caddy-dns/netlify

  trigger-ionos-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.ionos == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with ionos dns plugin
      license: MIT
      tag: ionos
      alpine_tag: ionos-alpine
      go_plugin_link: github.com/caddy-dns/ionos
      hash_file: git-hashes/ionos.txt
      plugin_name: ionos
      repo: https://github.com/caddy-dns/ionos

  trigger-porkbun-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.porkbun == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with porkbun dns plugin
      license: MIT
      tag: porkbun
      alpine_tag: porkbun-alpine
      go_plugin_link: github.com/caddy-dns/porkbun
      hash_file: git-hashes/porkbun.txt
      plugin_name: porkbun
      repo: https://github.com/caddy-dns/porkbun

  trigger-gandi-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.gandi == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with gandi dns plugin
      license: MIT
      tag: gandi
      alpine_tag: gandi-alpine
      go_plugin_link: github.com/caddy-dns/gandi
      hash_file: git-hashes/gandi.txt
      plugin_name: gandi
      repo: https://github.com/caddy-dns/gandi

  trigger-dynv6-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.dynv6 == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with dynv6 dns plugin
      license: MIT
      tag: dynv6
      alpine_tag: dynv6-alpine
      go_plugin_link: github.com/caddy-dns/dynv6
      hash_file: git-hashes/dynv6.txt
      plugin_name: dynv6
      repo: https://github.com/caddy-dns/dynv6

  trigger-openstack-designate-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.openstack-designate == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with openstack-designate dns plugin
      license: MIT
      tag: openstack-designate
      alpine_tag: openstack-designate-alpine
      go_plugin_link: github.com/caddy-dns/openstack-designate
      hash_file: git-hashes/openstack-designate.txt
      plugin_name: openstack-designate
      repo: https://github.com/caddy-dns/openstack-designate

  trigger-njalla-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.njalla == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with njalla dns plugin
      license: MIT
      tag: njalla
      alpine_tag: njalla-alpine
      go_plugin_link: github.com/caddy-dns/njalla
      hash_file: git-hashes/njalla.txt
      plugin_name: njalla
      repo: https://github.com/caddy-dns/njalla

  trigger-rfc2136-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.rfc2136 == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with rfc2136 dns plugin
      license: MIT
      tag: rfc2136
      alpine_tag: rfc2136-alpine
      go_plugin_link: github.com/caddy-dns/rfc2136
      hash_file: git-hashes/rfc2136.txt
      plugin_name: rfc2136
      repo: https://github.com/caddy-dns/rfc2136

  trigger-leaseweb-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.leaseweb == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with leaseweb dns plugin
      license: MIT
      tag: leaseweb
      alpine_tag: leaseweb-alpine
      go_plugin_link: github.com/caddy-dns/leaseweb
      hash_file: git-hashes/leaseweb.txt
      plugin_name: leaseweb
      repo: https://github.com/caddy-dns/leaseweb

  trigger-linode-build:
    needs: check-for-plugin-updates
    if: ${{ needs.check-for-plugin-updates.outputs.linode == 'true' }}
    uses: FarisZR/caddy-dns-OCI/.github/workflows/start-build.yml@main
    permissions:
      packages: write
      contents: write
    secrets: inherit
    with:
      dockerfile: Dockerfile
      dockerfile_alpine: Dockerfile-alpine
      image_title: Caddy with linode dns plugin
      license: MIT
      tag: linode
      alpine_tag: linode-alpine
      go_plugin_link: github.com/caddy-dns/linode
      hash_file: git-hashes/linode.txt
      plugin_name: linode
      repo: https://github.com/caddy-dns/linode